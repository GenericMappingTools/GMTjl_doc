<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>greenspline</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../assets/GMTjl_logo.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-0615b85506723fa54ab13a613a4e9e4c.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../custom.css">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../assets/GMTjl_logo.png" alt="" class="navbar-logo light-content">
    <img src="../../assets/GMTjl_logo.png" alt="" class="navbar-logo dark-content">
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-documentation" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Documentation</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-documentation">    
        <li>
    <a class="dropdown-item" href="../../documentation.html">
 <span class="dropdown-text">Overview</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li>
    <a class="dropdown-item" href="../../documentation/modules.html">
 <span class="dropdown-text">GMT Modules</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../documentation/general/types.html">
 <span class="dropdown-text">GMT.jl Types</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../documentation/extensions.html">
 <span class="dropdown-text">GMT.jl Extensions</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../documentation/gdalfuns.html">
 <span class="dropdown-text">GDAL Functions</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../documentation/solids.html">
 <span class="dropdown-text">Solids Functions</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../documentation/imgproc.html">
 <span class="dropdown-text">Image Processing</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../documentation/common_features.html">
 <span class="dropdown-text">Common Features</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../documentation/alphabetical.html">
 <span class="dropdown-text">Alphabetical List</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../../examples.html"> 
<span class="menu-text">Examples</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-gallery-(gmt-gallery" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Gallery (GMT Gallery)</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-gallery-(gmt-gallery">    
        <li>
    <a class="dropdown-item" href="../../gallery.html">
 <span class="dropdown-text">Overview</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li>
    <a class="dropdown-item" href="../../gallery/ex01.html">
 <span class="dropdown-text">(1) Contour maps</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../gallery/ex02.html">
 <span class="dropdown-text">(2) Image presentations</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../gallery/ex03.html">
 <span class="dropdown-text">(3) Spectral estimation and xy-plots</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../gallery/ex04.html">
 <span class="dropdown-text">(4)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../gallery/ex05.html">
 <span class="dropdown-text">(5) A 3-D illuminated surface</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../gallery/ex06.html">
 <span class="dropdown-text">(6) Plotting of histograms</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../gallery/ex07.html">
 <span class="dropdown-text">(7) A simple location map</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../gallery/ex08.html">
 <span class="dropdown-text">(8) A 3-D histogram</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../gallery/ex09.html">
 <span class="dropdown-text">(9) Time-series along tracks</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../gallery/ex10.html">
 <span class="dropdown-text">(10) A geographical bar graph plot</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../gallery/ex11.html">
 <span class="dropdown-text">(11)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../gallery/ex12.html">
 <span class="dropdown-text">(12) Optimal triangulation of data</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../gallery/ex13.html">
 <span class="dropdown-text">(13) Plotting of vector fields</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../gallery/ex14.html">
 <span class="dropdown-text">(14) Gridding of data and trend surfaces</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../gallery/ex15.html">
 <span class="dropdown-text">(15) Gridding, contouring, and masking of unconstrained areas</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../gallery/ex16.html">
 <span class="dropdown-text">(16) Gridding of data, continued</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../gallery/ex17.html">
 <span class="dropdown-text">(17) Images clipped by coastlines</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../gallery/ex18.html">
 <span class="dropdown-text">(18) Volumes and Spatial Selections</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../gallery/ex19.html">
 <span class="dropdown-text">(19) Color patterns on maps</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../gallery/ex20.html">
 <span class="dropdown-text">(20) Custom plot symbols</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../gallery/ex21.html">
 <span class="dropdown-text">(21) Time-series of RedHat stock price</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../gallery/ex22.html">
 <span class="dropdown-text">(22)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../gallery/ex23.html">
 <span class="dropdown-text">(23)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../gallery/ex24.html">
 <span class="dropdown-text">(24)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../gallery/ex25.html">
 <span class="dropdown-text">(25)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../gallery/ex26.html">
 <span class="dropdown-text">(26)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../gallery/ex27.html">
 <span class="dropdown-text">(27)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../gallery/ex28.html">
 <span class="dropdown-text">(28)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../gallery/ex29.html">
 <span class="dropdown-text">(29)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../gallery/ex30.html">
 <span class="dropdown-text">(30)</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-tutorials" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Tutorials</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-tutorials">    
        <li>
    <a class="dropdown-item" href="../../tutorials.html">
 <span class="dropdown-text">Overview</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li>
    <a class="dropdown-item" href="../../tutorials/ISC/isc.jl.html">
 <span class="dropdown-text">ISC seismicity</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../tutorials/Landsat8/histogram_stretch.html">
 <span class="dropdown-text">Landsat 8/9</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../tutorials/coast/coastlines.html">
 <span class="dropdown-text">Coastlines</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../tutorials/choropleths/choropleths.html">
 <span class="dropdown-text">US Choropleths</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../tutorials/dlakelan/GMTMaps.html">
 <span class="dropdown-text"><span class="citation" data-cites="dlakelan">@dlakelan</span> choropleths</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../tutorials/longest_sail/longestsail.html">
 <span class="dropdown-text">Longest Sail</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../tutorials/vector_shp/vector_shp.html">
 <span class="dropdown-text">Geospatial vector</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../tutorials/texture_shading/texture.html">
 <span class="dropdown-text">Texture Shading</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../tutorials/mosaics/mosaics.html">
 <span class="dropdown-text">Mosaics</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../tutorials/insets/insets.html">
 <span class="dropdown-text">Insets</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../tutorials/remote_datasets/remote_datasets.html">
 <span class="dropdown-text">Remote Grids</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../tutorials/blender_shading/blender_rt.html">
 <span class="dropdown-text">Blender</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../tutorials/signal/signal.html">
 <span class="dropdown-text">Signal</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-geophysics" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Geophysics</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-geophysics">    
        <li>
    <a class="dropdown-item" href="../../geophysics.html">
 <span class="dropdown-text">Overview</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li>
    <a class="dropdown-item" href="../../geophysics/seismicity/global_seis.html">
 <span class="dropdown-text">Seismicity</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../geophysics/earthtides/01_earthtides.html">
 <span class="dropdown-text">Earth Tides</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../geophysics/weather/01_weather.html">
 <span class="dropdown-text">Weather Data</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-help" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Help</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-help">    
        <li>
    <a class="dropdown-item" href="https://github.com/GenericMappingTools/GMT.jl/issues"><i class="bi bi-bug" role="img">
</i> 
 <span class="dropdown-text">Report a Bug</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://forum.generic-mapping-tools.org/c/questions/5"><i class="bi bi-chat-right-text" role="img">
</i> 
 <span class="dropdown-text">Ask a Question</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul class="collapse">
  <li><a href="#synopsis" id="toc-synopsis" class="nav-link active" data-scroll-target="#synopsis">Synopsis</a></li>
  <li><a href="#description" id="toc-description" class="nav-link" data-scroll-target="#description">Description</a></li>
  <li><a href="#required-arguments" id="toc-required-arguments" class="nav-link" data-scroll-target="#required-arguments">Required Arguments</a></li>
  <li><a href="#optional-arguments" id="toc-optional-arguments" class="nav-link" data-scroll-target="#optional-arguments">Optional Arguments</a></li>
  <li><a href="#examples" id="toc-examples" class="nav-link" data-scroll-target="#examples">Examples</a></li>
  <li><a href="#notes" id="toc-notes" class="nav-link" data-scroll-target="#notes">Notes</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  <li><a href="#source-code" id="toc-source-code" class="nav-link" data-scroll-target="#source-code">Source Code</a></li>
  <li><a href="#see-also" id="toc-see-also" class="nav-link" data-scroll-target="#see-also">See Also</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">greenspline</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Interpolate using Green’s functions for splines in 1-3 dimensions</p>
<p>(<strong>Warning: Manual translate by Claude. Needs revision</strong>)</p>
<section id="synopsis" class="level2">
<h2 class="anchored" data-anchor-id="synopsis">Synopsis</h2>
<p><strong>greenspline</strong> <em>table</em> [ <strong>A</strong> | <strong>gradient</strong>] [ <strong>C</strong> | <strong>approx</strong>| <strong>approximate</strong> ] [ <strong>D</strong> | <strong>metadata</strong> | <strong>metadata</strong>] [ <strong>E</strong> | <strong>misfit</strong>] [ <strong>G</strong> | <strong>outgrid</strong> | <strong>save</strong> ] [ <strong>I</strong> | <strong>inc</strong> | <strong>increment</strong> | <strong>spacing</strong> ] [ <strong>L</strong> | <strong>leave_trend</strong> ] [ <strong>N</strong> | <strong>nodes</strong>] [ <strong>Q</strong> | dir_derivative] [ <strong>R</strong> | <strong>region</strong> | <strong>limits</strong> ] [ <strong>S</strong> | <strong>splines</strong> ] [ <strong>T</strong> | <strong>mask</strong>] [ <strong>V</strong> | <strong>verbose</strong> ] [ <strong>W</strong> | <strong>uncertainties</strong>] [ <strong>Z</strong> | <strong>mode</strong> | <strong>distmode</strong> ] [ <strong>b</strong> | <strong>binary</strong> ] [ <strong>d</strong> | <strong>nodata</strong> ] [ <strong>e</strong> | <strong>pattern</strong> ] [ <strong>f</strong> | <strong>colinfo</strong> ] [ <strong>h</strong> | <strong>header</strong> ] [ <strong>i</strong> | <strong>incol</strong> | <strong>incols</strong> ] [ <strong>o</strong> | <strong>outcol</strong> | <strong>outcols</strong> ] [ <strong>r</strong> | <strong>reg</strong> | <strong>registration</strong> ] [ <strong>x</strong> | <strong>cores</strong> ] [ <strong>:</strong> | <strong>yx</strong> ]</p>
</section>
<section id="description" class="level2">
<h2 class="anchored" data-anchor-id="description">Description</h2>
<p><strong>greenspline</strong> uses the Green’s function for the chosen spline and geometry to interpolate data at regular or arbitrary output locations. Choose between minimum curvature, regularized, or continuous curvature splines in tension for either 1-D, 2-D, or 3-D Cartesian coordinates or spherical surface coordinates. Mathematically, the solution is composed as a sum of Green’s functions and a trend function. The unknown coefficients are determined by requiring the solution to fit the observed data points exactly or approximately (via SVD).</p>
</section>
<section id="required-arguments" class="level2">
<h2 class="anchored" data-anchor-id="required-arguments">Required Arguments</h2>
<ul>
<li><em>table</em><br>
The name of one or more data files (or a <a href="../..\documentation/general/types.html#sec-dataset-type">GMTdataset</a> or Matrix) holding the x, w data points. If no input is given then standard input is read.</li>
</ul>
</section>
<section id="optional-arguments" class="level2">
<h2 class="anchored" data-anchor-id="optional-arguments">Optional Arguments</h2>
<ul>
<li><p><strong>A</strong> or <strong>gradient</strong> : – <em>gradient=gradfile</em> <strong>|</strong> <em>gradient=“gradfile+f1”</em><br>
Append name of file with surface gradients to partly constrain the solution. Use modifier <strong>+f</strong> to select one of these input formats:</p>
<ul>
<li><strong>0</strong>: For 1-D data, gradient magnitude (slope) only: x, v</li>
<li><strong>1</strong>: Records contain x, y, azimuth, v (azimuth in degrees clockwise from north) [Default for 2-D]</li>
<li><strong>2</strong>: Records contain x, y, v, azimuth<br>
</li>
<li><strong>3</strong>: Records contain x, direction(s), v (directions counter-clockwise from horizontal)</li>
<li><strong>4</strong>: Records contain x, gradient components (2-D or 3-D)</li>
<li><strong>5</strong>: Records contain x, unit vector, v (2-D or 3-D)</li>
</ul></li>
<li><p><strong>C</strong> or <strong>approx</strong> or <strong>approximate</strong> : – <em>approx=cutoff</em> <strong>|</strong> <em>approx=(n=:, mode=:r, cutoff=0.01, file=“eigen.txt”, cumulative=true, incremental=true, dryrun=true)</em><br>
Find an approximate surface fit using singular value decomposition (SVD) and eliminate contribution from smaller eigenvalues [Default uses Gauss-Jordan elimination for exact fit]. Append a directive:</p>
<ul>
<li><strong>n</strong>: Retain only the specified number of largest eigenvalues (e.g., <code>C=(n=100,)</code>)</li>
<li><strong>r</strong>: Retain eigenvalues whose ratio to largest eigenvalue is less than value [Default]</li>
<li><strong>v</strong>: Retain eigenvalues needed to ensure model prediction variance fraction is at least value</li>
</ul>
<p>Optional modifiers (use as named tuple members):</p>
<ul>
<li><strong>cumulative=true</strong>: Produce cumulative sum of contributions, one grid per eigenvalue (2-D only)</li>
<li><strong>incremental=true</strong>: Produce incremental sum of contributions, one grid per eigenvalue (2-D only)</li>
<li><strong>file=“filename”</strong>: Save eigenvalues to specified file</li>
<li><strong>dryrun=true</strong>: Save eigenvalues and exit without surface output (requires <strong>file</strong>)</li>
</ul></li>
<li><p><strong>D</strong> or <strong>meta</strong> or <strong>metadata</strong>: – <em>meta=(xname=“…”, yname=“…”, zname=“…”, vname=“…”, …)</em><br>
Control netCDF grid metadata. Use named tuple with these optional members:</p>
<ul>
<li><strong>xname</strong>, <strong>yname</strong>, <strong>zname</strong>: Dimension names (with optional units in brackets)</li>
<li><strong>vname</strong>: Variable name for data</li>
<li><strong>scale</strong>, <strong>offset</strong>: Scale factor and offset for data values</li>
<li><strong>invalid</strong>: Value used for NaN or missing data</li>
<li><strong>title</strong>, <strong>remark</strong>: Title and remark strings</li>
</ul></li>
<li><p><strong>E</strong> or <strong>misfit</strong> : – <em>misfit=true</em> <strong>|</strong> <em>misfit=“misfitfile”</em> <strong>|</strong> <em>misfit=(misfitfile=“…”, reportfile=“…”)</em><br>
Evaluate spline exactly at input data locations and report misfit statistics. If <code>E=true</code>, statistics are written to stderr. If a filename is given, write data table augmented by spline estimate and misfit columns. If <strong>C</strong> is used with history modifiers, write eigenvalue analysis table instead. Use named tuple for multiple outputs: <code>julia     E=(misfitfile="misfit.txt", reportfile="report.txt")</code></p></li>
<li><p><strong>G</strong> or <strong>outgrid</strong> or <strong>save</strong> : – <em>save=“outfile.grd”</em> <strong>|</strong> <em>save=“table.txt”</em><br>
Specify output filename. For 2-D grids, a grid file is required. For 3-D, can be a cube file, a template for multiple 2-D grids (with floating-point format like <code>"layer_%g.grd"</code>), or omitted for ASCII/binary table output. For arbitrary output locations (with <strong>N</strong>), this specifies the output table name. Ignored if <strong>C</strong> is specified.</p></li>
<li><p><strong>I</strong> or <strong>inc</strong> or <strong>increment</strong> or <strong>spacing</strong> : – <em>inc=xinc</em> <strong>|</strong> <em>inc=(xinc,yinc)</em> <strong>|</strong> <em>inc=(xinc,yinc,zinc)</em><br>
Specify equidistant sampling intervals. For 1-D, give xinc; for 2-D, give xinc and yinc; for 3-D, give xinc, yinc, and zinc.</p></li>
<li><p><strong>L</strong> or <strong>leave_trend</strong> : – <em>leave_trend=true</em> <strong>|</strong> <em>leave_trend=:t</em> <strong>|</strong> <em>leave_trend=:r</em> <strong>|</strong> <em>leave_trend=:tr</em><br>
Control detrending and normalization of data prior to solving. Append directives:</p>
<ul>
<li><strong>:t</strong>: Remove and restore linear least-squares trend</li>
<li><strong>:r</strong>: Normalize and restore data by maximum absolute residual value</li>
</ul>
<p>Default applies both detrending and normalization when geometrically permissible.</p></li>
<li><p><strong>N</strong> or <strong>nodes</strong> : – <em>nodes=“nodefile”</em><br>
ASCII file with coordinates of desired output locations in the first column(s). The resulting values are appended to each record and written to the file given in <strong>G</strong> (or stdout).</p></li>
<li><p><strong>Q</strong> or <strong>dir_derivative</strong> : – <em>dir_derivative=az</em> <strong>|</strong> <em>dir_derivative=(x,y,z)</em><br>
Take directional derivative instead of evaluating solution. For 1-D, give nothing (uses derivative). For 2-D, give azimuth in degrees. For 3-D, give three components of desired vector direction as a tuple; the vector will be normalized.</p></li>
<li><p><strong>R</strong> or <strong>region</strong> or <strong>limits</strong> : – <em>limits=(xmin, xmax, ymin, ymax)</em> <strong>|</strong> <em>limits=(BB=(xmin, xmax, ymin, ymax),)</em> <strong>|</strong> <em>limits=(LLUR=(xmin, xmax, ymin, ymax),units=“unit”)</em> <strong>|</strong> …more<br>
Specify the region of interest. More at [limits](../common_opts/opt_R.html). For perspective view <strong>view</strong>, optionally add <em>zmin,zmax</em>. This option may be used to indicate the range used for the 3-D axes. You may ask for a larger w/e/s/n region to have more room between the image and the axes.</p></li>
<li><p><strong>S</strong> oe <strong>splines</strong> : – <em>splines=:c</em> <strong>|</strong> <em>splines=:t</em> <strong>|</strong> <em>splines=(:t, tension)</em> <strong>|</strong> <em>splines=(:q, tension, params…)</em><br>
Select spline type. Append directive for spline selection:</p>
<ul>
<li><strong>:c</strong>: Minimum curvature spline (1-D, 2-D, or 3-D Cartesian)</li>
<li><strong>:l</strong>: Linear or bilinear spline (1-D or 2-D Cartesian)</li>
<li><strong>:p</strong>: Minimum curvature spline for spherical surface (Parker, 1994)</li>
<li><strong>:q</strong>: Continuous curvature spline in tension for spherical surface (Wessel &amp; Becker, 2008); append tension</li>
<li><strong>:r</strong>: Regularized spline in tension (Mitasova &amp; Mitas, 1993); append tension and optional scale</li>
<li><strong>:t</strong>: Continuous curvature spline in tension (Wessel &amp; Bercovici, 1998); append tension and optional scale</li>
</ul>
<p>For <strong>:q</strong>, optional modifiers as named tuple:</p>
<ul>
<li><strong>limit</strong>: Truncation error for Legendre sum [1e-6]</li>
<li><strong>n</strong>: Number of points in spline setup [10001] (must be odd)</li>
</ul>
<p>Example: <code>julia   S=(:t, 0.7)                           # Tension 0.7   S=(:r, 0.95, 50)                      # Tension 0.95, scale 50   S=(:q, 0.85, limit=1e-8, n=15001)     # Spherical with custom parameters</code></p></li>
<li><p><strong>T</strong> or <strong>mask</strong> : – <em>mask=“maskgrid”</em><br>
For 2-D interpolation only. Evaluate solution only at nodes in maskgrid that are not NaN. This option eliminates the need for <strong>R</strong>, <strong>I</strong>, and <strong>r</strong>.</p></li>
<li><p><strong>V</strong> or <em>verbose</em> : – <em>verbose=true</em> <strong>|</strong> <em>verbose=level</em><br>
Select verbosity level. More at [verbose](../common_opts/opt_V.html)</p></li>
<li><p><strong>W</strong> or <strong>uncertainties</strong> : – <em>uncertainties=true</em> <strong>|</strong> <em>uncertainties=:w</em><br>
Data one-sigma uncertainties are in the last column. Compute weights inversely proportional to uncertainties squared. Append <strong>:w</strong> if weights are given directly instead of uncertainties (no squaring). Results in weighted least squares fit. Only has effect with <strong>C</strong>.</p></li>
<li><p><strong>Z</strong> or <strong>mode</strong> or <strong>distmode</strong> : – <em>distmode=mode</em><br>
Set distance mode for calculating distances between data points:</p>
<ul>
<li><strong>0</strong>: (x) in user units, Cartesian distances (1-D)</li>
<li><strong>1</strong>: (x,y) in user units, Cartesian distances (2-D)</li>
<li><strong>2</strong>: (x,y) in degrees, Flat Earth distances (2-D)</li>
<li><strong>3</strong>: (x,y) in degrees, Spherical distances in km (2-D)</li>
<li><strong>4</strong>: (x,y) in degrees, cosine of great circle arcs (spherical surface; requires <strong>S=:p</strong> or <strong>S=:q</strong>)</li>
<li><strong>5</strong>: (x,y,z) in user units, Cartesian distances (3-D)</li>
</ul></li>
<li><p><strong>bi</strong> or <strong>binary_in</strong> : – <em>binary_in=??</em><br>
Select native binary format for primary table input. <a href="https://docs.generic-mapping-tools.org/dev/gmt.html#bi-full">More at</a></p></li>
<li><p><strong>di</strong> or <strong>nodata_in</strong> : – <em>nodata_in=??</em><br>
Substitute specific values with NaN. <a href="https://docs.generic-mapping-tools.org/dev/gmt.html#di-full">More at</a></p></li>
<li><p><strong>e</strong> or <strong>pattern</strong> : – <em>pattern=??</em><br>
Only accept ASCII data records that contain the specified pattern. <a href="https://docs.generic-mapping-tools.org/dev/gmt.html#e-full">More at</a></p></li>
<li><p><strong>f</strong> or <strong>colinfo</strong> : – <em>colinfo=??</em><br>
Specify the data types of input and/or output columns (time or geographical data). <a href="https://docs.generic-mapping-tools.org/dev/gmt.html#f-full">More at</a></p></li>
<li><p><strong>h</strong> or <strong>header</strong> : – <em>header=??</em><br>
Specify that input and/or output file(s) have n header records. <a href="https://docs.generic-mapping-tools.org/dev/gmt.html#h-full">More at</a></p></li>
<li><p><strong>i</strong> or <strong>incol</strong> or <strong>incols</strong> : – <em>incol=col_num</em> <strong>|</strong> <em>incol=“opts”</em><br>
Select input columns and transformations (0 is first column, t is trailing text, append word to read one word only). More at <a href="https://docs.generic-mapping-tools.org/dev/gmt.html#icols-full">incol</a></p></li>
<li><p><strong>o</strong> or <strong>outcol</strong> : – <em>outcol=??</em><br>
Select specific data columns for primary output, in arbitrary order. <a href="https://docs.generic-mapping-tools.org/dev/gmt.html#ocols-full">More at</a></p></li>
<li><p><strong>R</strong> or <strong>region</strong> or <strong>limits</strong> : – <em>limits=(xmin, xmax, ymin, ymax)</em> <strong>|</strong> <em>limits=(BB=(xmin, xmax, ymin, ymax),)</em> <strong>|</strong> <em>limits=(LLUR=(xmin, xmax, ymin, ymax),units=“unit”)</em> <strong>|</strong> …more<br>
Specify the region of interest. More at [limits](../common_opts/opt_R.html). For perspective view <strong>view</strong>, optionally add <em>zmin,zmax</em>. This option may be used to indicate the range used for the 3-D axes. You may ask for a larger w/e/s/n region to have more room between the image and the axes.</p></li>
<li><p><strong>X</strong> or <strong>xshift</strong> or <strong>x_offset</strong> : <em>xshift=true</em> <strong>|</strong> <em>xshift=x-shift</em> <strong>|</strong> <em>xshift=(shift=x-shift, mov=“a|c|f|r”)</em><br>
Shift plot origin. More at [xshift](../common_opts/opt_X.html)</p></li>
<li><p><strong>yx</strong> : – <em>yx=true</em><br>
Swap 1st and 2nd column on input and/or output. <a href="https://docs.generic-mapping-tools.org/dev/gmt.html#colon-full">More at</a></p></li>
</ul>
</section>
<section id="examples" class="level2">
<h2 class="anchored" data-anchor-id="examples">Examples</h2>
<section id="d-spline" class="level3">
<h3 class="anchored" data-anchor-id="d-spline">1-D Spline</h3>
<p>Resample 1-D data using minimum curvature spline:</p>
<div id="43e702ce" class="cell" data-execution_count="1">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">GMT</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create sample data</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> [<span class="fl">1.0</span> <span class="fl">2.0</span>; <span class="fl">3.0</span> <span class="fl">4.5</span>; <span class="fl">5.0</span> <span class="fl">3.0</span>; <span class="fl">7.0</span> <span class="fl">5.5</span>; <span class="fl">9.0</span> <span class="fl">6.0</span>];</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Minimum curvature spline</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> <span class="fu">greenspline</span>(data, region<span class="op">=</span><span class="st">"0/10"</span>, inc<span class="op">=</span><span class="fl">0.1</span>, S<span class="op">=:</span>c);</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(data)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot!</span>(result, lc<span class="op">=:</span>blue, show<span class="op">=</span><span class="cn">true</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="greenspline_files/figure-html/cell-2-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Spline in tension (tension = 0.7):</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb2"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> <span class="fu">greenspline</span>(data, region<span class="op">=</span><span class="st">"0/10"</span>, inc<span class="op">=</span><span class="fl">0.1</span>, S<span class="op">=</span>(<span class="op">:</span>t, <span class="fl">0.7</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="d-cartesian-grid" class="level3">
<h3 class="anchored" data-anchor-id="d-cartesian-grid">2-D Cartesian Grid</h3>
<p>Create uniform grid using minimum curvature spline:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb3"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load data</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> <span class="fu">gmtread</span>(<span class="st">"@Table_5_11.txt"</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Minimum curvature spline</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>G <span class="op">=</span> <span class="fu">greenspline</span>(data, region<span class="op">=</span>(<span class="fl">0</span>,<span class="fl">6.5</span>,<span class="op">-</span><span class="fl">0.2</span>,<span class="fl">6.5</span>), inc<span class="op">=</span><span class="fl">0.1</span>, S<span class="op">=:</span>c, Z<span class="op">=</span><span class="fl">1</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Spline in tension with mask:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb4"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Only evaluate where mask is not NaN</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>G <span class="op">=</span> <span class="fu">greenspline</span>(data, T<span class="op">=</span><span class="st">"mask.nc"</span>, S<span class="op">=</span>(<span class="op">:</span>t, <span class="fl">0.5</span>), Z<span class="op">=</span><span class="fl">1</span>, save<span class="op">=</span><span class="st">"result.nc"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Regularized spline in tension:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb5"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Return directional derivative (NW direction, -45°)</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>G <span class="op">=</span> <span class="fu">greenspline</span>(data, region<span class="op">=</span>(<span class="fl">0</span>,<span class="fl">6.5</span>,<span class="op">-</span><span class="fl">0.2</span>,<span class="fl">6.5</span>), inc<span class="op">=</span><span class="fl">0.1</span>, S<span class="op">=</span>(<span class="op">:</span>r, <span class="fl">0.95</span>), </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>                Z<span class="op">=</span><span class="fl">1</span>, Q<span class="op">=-</span><span class="fl">45</span>, save<span class="op">=</span><span class="st">"slopes.nc"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="approximate-fit-with-svd" class="level3">
<h3 class="anchored" data-anchor-id="approximate-fit-with-svd">Approximate Fit with SVD</h3>
<p>Cartesian cubic spline retaining 100 largest eigenvalues:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb6"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>G <span class="op">=</span> <span class="fu">greenspline</span>(data, region<span class="op">=</span>(<span class="fl">0</span>,<span class="fl">6.5</span>,<span class="op">-</span><span class="fl">0.2</span>,<span class="fl">6.5</span>), inc<span class="op">=</span><span class="fl">0.1</span>, S<span class="op">=:</span>c, Z<span class="op">=</span><span class="fl">1</span>, </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>                C<span class="op">=</span>(n<span class="op">=</span><span class="fl">100</span>,), save<span class="op">=</span><span class="st">"approx.nc"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Evaluate cumulative contributions:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb7"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creates files contribution_cum_000.nc, contribution_cum_001.nc, etc.</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">greenspline</span>(data, region<span class="op">=</span>(<span class="fl">0</span>,<span class="fl">6.5</span>,<span class="op">-</span><span class="fl">0.2</span>,<span class="fl">6.5</span>), inc<span class="op">=</span><span class="fl">0.1</span>, S<span class="op">=:</span>c, Z<span class="op">=</span><span class="fl">1</span>,</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>            C<span class="op">=</span>(cumulative<span class="op">=</span><span class="cn">true</span>,), save<span class="op">=</span><span class="st">"contribution.nc"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="surface-with-gradient-constraints" class="level3">
<h3 class="anchored" data-anchor-id="surface-with-gradient-constraints">Surface with Gradient Constraints</h3>
<p>Recover surface from single point value and gradient constraints:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb8"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Point data in pt.txt, gradients in slopes.txt  </span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>G <span class="op">=</span> <span class="fu">greenspline</span>(<span class="st">"pt.txt"</span>, region<span class="op">=</span>(<span class="op">-</span><span class="fl">3.2</span>,<span class="fl">3.2</span>,<span class="op">-</span><span class="fl">3.2</span>,<span class="fl">3.2</span>), inc<span class="op">=</span><span class="fl">0.1</span>, S<span class="op">=:</span>c, Z<span class="op">=</span><span class="fl">1</span>,</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>                A<span class="op">=</span><span class="st">"slopes.txt+f1"</span>, save<span class="op">=</span><span class="st">"surface.nc"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="d-cartesian-interpolation" class="level3">
<h3 class="anchored" data-anchor-id="d-cartesian-interpolation">3-D Cartesian Interpolation</h3>
<p>Create 3-D grid from (x,y,z,w) data:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb9"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ASCII table output</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> <span class="fu">greenspline</span>(<span class="st">"@Table_5_23.txt"</span>, region<span class="op">=</span>(<span class="fl">5</span>,<span class="fl">40</span>,<span class="op">-</span><span class="fl">5</span>,<span class="fl">10</span>,<span class="fl">5</span>,<span class="fl">16</span>), </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>                     inc<span class="op">=</span><span class="fl">0.25</span>, S<span class="op">=</span>(<span class="op">:</span>r, <span class="fl">0.85</span>), Z<span class="op">=</span><span class="fl">5</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Multiple 2-D layer grids</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="fu">greenspline</span>(<span class="st">"@Table_5_23.txt"</span>, region<span class="op">=</span>(<span class="fl">5</span>,<span class="fl">40</span>,<span class="op">-</span><span class="fl">5</span>,<span class="fl">10</span>,<span class="fl">5</span>,<span class="fl">16</span>), inc<span class="op">=</span><span class="fl">0.25</span>,</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>            S<span class="op">=</span>(<span class="op">:</span>r, <span class="fl">0.85</span>), Z<span class="op">=</span><span class="fl">5</span>, save<span class="op">=</span><span class="st">"layer_%g.grd"</span>)</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Single 3-D netCDF cube</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="fu">greenspline</span>(<span class="st">"@Table_5_23.txt"</span>, region<span class="op">=</span>(<span class="fl">5</span>,<span class="fl">40</span>,<span class="op">-</span><span class="fl">5</span>,<span class="fl">10</span>,<span class="fl">5</span>,<span class="fl">16</span>), inc<span class="op">=</span><span class="fl">0.25</span>,</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>            S<span class="op">=</span>(<span class="op">:</span>r, <span class="fl">0.85</span>), Z<span class="op">=</span><span class="fl">5</span>, save<span class="op">=</span><span class="st">"cube3d.nc"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="spherical-surface-interpolation" class="level3">
<h3 class="anchored" data-anchor-id="spherical-surface-interpolation">Spherical Surface Interpolation</h3>
<p>Global grid using Parker spline:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb10"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Minimum curvature on sphere</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>G <span class="op">=</span> <span class="fu">greenspline</span>(<span class="st">"@mag_obs_1990.txt"</span>, region<span class="op">=:</span><span class="kw">global</span>, inc<span class="op">=</span><span class="fl">1</span>, S<span class="op">=:</span>p, Z<span class="op">=</span><span class="fl">3</span>);</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>With tension:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb11"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Continuous curvature in tension (tension = 0.85)</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>G <span class="op">=</span> <span class="fu">greenspline</span>(<span class="st">"@mag_obs_1990.txt"</span>, region<span class="op">=:</span><span class="kw">global</span>, inc<span class="op">=</span><span class="fl">1</span>, S<span class="op">=</span>(<span class="op">:</span>q, <span class="fl">0.85</span>), Z<span class="op">=</span><span class="fl">3</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="arbitrary-output-locations" class="level3">
<h3 class="anchored" data-anchor-id="arbitrary-output-locations">Arbitrary Output Locations</h3>
<p>Output at specific coordinates:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb12"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Nodes specified in nodefile.txt</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">greenspline</span>(data, N<span class="op">=</span><span class="st">"nodefile.txt"</span>, S<span class="op">=:</span>c, Z<span class="op">=</span><span class="fl">1</span>, save<span class="op">=</span><span class="st">"output.txt"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="misfit-evaluation" class="level3">
<h3 class="anchored" data-anchor-id="misfit-evaluation">Misfit Evaluation</h3>
<p>Evaluate fit quality:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb13"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Statistics to stderr</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">greenspline</span>(data, region<span class="op">=</span>(<span class="fl">0</span>,<span class="fl">6.5</span>,<span class="op">-</span><span class="fl">0.2</span>,<span class="fl">6.5</span>), inc<span class="op">=</span><span class="fl">0.1</span>, S<span class="op">=:</span>c, Z<span class="op">=</span><span class="fl">1</span>, </span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>            E<span class="op">=</span><span class="cn">true</span>, save<span class="op">=</span><span class="st">"grid.nc"</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Write augmented data table with estimates and misfits</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="fu">greenspline</span>(data, region<span class="op">=</span>(<span class="fl">0</span>,<span class="fl">6.5</span>,<span class="op">-</span><span class="fl">0.2</span>,<span class="fl">6.5</span>), inc<span class="op">=</span><span class="fl">0.1</span>, S<span class="op">=:</span>c, Z<span class="op">=</span><span class="fl">1</span>,</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>            E<span class="op">=</span><span class="st">"misfits.txt"</span>, save<span class="op">=</span><span class="st">"grid.nc"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
</section>
<section id="notes" class="level2">
<h2 class="anchored" data-anchor-id="notes">Notes</h2>
<section id="memory-requirements" class="level3">
<h3 class="anchored" data-anchor-id="memory-requirements">Memory Requirements</h3>
<p>The solution requires inverting an n × n double precision matrix, where n is the number of data constraints. Memory usage scales as n²: - n = 1,024: ~8 MB - n = 10,240: ~800 MB</p>
<p>Pre-process data with <strong>blockmean</strong>, <strong>blockmedian</strong>, or <strong>blockmode</strong> to avoid aliasing and control n.&nbsp;For spherical data, use <strong>gmtspatial</strong> nearest neighbor reduction.</p>
</section>
<section id="boundary-conditions" class="level3">
<h3 class="anchored" data-anchor-id="boundary-conditions">Boundary Conditions</h3>
<p>For Cartesian cases, free-space Green functions are used, so no boundary conditions apply at domain edges. For specific boundary conditions, consider using <strong>surface</strong> instead.</p>
</section>
<section id="numerical-stability" class="level3">
<h3 class="anchored" data-anchor-id="numerical-stability">Numerical Stability</h3>
<p>The inversion can become unstable when data neighbors are very close compared to the overall data span. Remedies: - Pre-process data by averaging closely spaced neighbors - Use SVD solution (<strong>C</strong>) and discard smallest eigenvalues</p>
</section>
<section id="tension-parameter" class="level3">
<h3 class="anchored" data-anchor-id="tension-parameter">Tension Parameter</h3>
<p>Tension suppresses spurious oscillations from minimum curvature requirement, especially with rapid gradient changes: - <strong>Smooth data</strong> (e.g., potential fields): Little or no tension needed - <strong>Rough data</strong> (e.g., topography): Moderate tension typically better</p>
<p>Experiment with a range of values. For regularized spline (<strong>S=:r</strong>), the scale value has limited stable range—experiment to find valid settings.</p>
</section>
<section id="d-splines" class="level3">
<h3 class="anchored" data-anchor-id="d-splines">1-D Splines</h3>
<p>Unlike <strong>sample1d</strong> (which offers traditional splines with standard boundary conditions like natural cubic spline), <strong>greenspline</strong>’s 1-D spline does not specify boundary conditions at domain ends.</p>
</section>
<section id="eigenvalue-selection" class="level3">
<h3 class="anchored" data-anchor-id="eigenvalue-selection">Eigenvalue Selection</h3>
<p>For approximate fits (<strong>C</strong>), it may be difficult to determine how many eigenvalues to retain. The <strong>cumulative</strong> and <strong>incremental</strong> modifiers create solutions for all cutoff selections, allowing animation to explore changes and select appropriate <strong>C</strong> values. See GMT animations for examples.</p>
</section>
<section id="spherical-splines" class="level3">
<h3 class="anchored" data-anchor-id="spherical-splines">Spherical Splines</h3>
<p>The series solution for <strong>S=:q</strong> (Wessel &amp; Becker, 2008) is slower to compute, so values are pre-calculated and cubic spline interpolation lookup is used. Optional modifiers <strong>limit</strong> and <strong>n</strong> control accuracy and performance.</p>
</section>
</section>
<section id="references" class="level2">
<h2 class="anchored" data-anchor-id="references">References</h2>
<ul>
<li>Davis, J. C., 1986, <em>Statistics and Data Analysis in Geology</em>, 2nd Edition, 646 pp., Wiley, New York.</li>
<li>Mitasova, H., and L. Mitas, 1993, Interpolation by regularized spline with tension: I. Theory and implementation, <em>Math. Geol.</em>, 25, 641-655.</li>
<li>Parker, R. L., 1994, <em>Geophysical Inverse Theory</em>, 386 pp., Princeton Univ. Press, Princeton, N.J.</li>
<li>Sandwell, D. T., 1987, Biharmonic spline interpolation of Geos-3 and Seasat altimeter data, <em>Geophys. Res. Lett.</em>, 14, 139-142.</li>
<li>Wessel, P., and D. Bercovici, 1998, Interpolation with splines in tension: a Green’s function approach, <em>Math. Geol.</em>, 30, 77-93, https://doi.org/10.1023/A:1021713421882.</li>
<li>Wessel, P., and J. M. Becker, 2008, Interpolation using a generalized Green’s function for a spherical surface spline in tension, <em>Geophys. J. Int</em>, 174, 21-28, https://doi.org/10.1111/j.1365-246X.2008.03829.x.</li>
<li>Wessel, P., 2009, A general-purpose Green’s function interpolator, <em>Computers &amp; Geosciences</em>, 35, 1247-1254, https://doi.org/10.1016/j.cageo.2008.08.012.</li>
</ul>
</section>
<section id="source-code" class="level2">
<h2 class="anchored" data-anchor-id="source-code">Source Code</h2>
<p>This function has multiple methods:</p>
<ul>
<li><a href="https://github.com/GenericMappingTools/GMT.jl/blob/master/src/greenspline.jl#L76"><code>greenspline(cmd0::String; kwargs...)</code></a> - greenspline.jl:76</li>
<li><a href="https://github.com/GenericMappingTools/GMT.jl/blob/master/src/greenspline.jl#L77"><code>greenspline(arg1; kwargs...)</code></a> - greenspline.jl:77</li>
</ul>
</section>
<section id="see-also" class="level2">
<h2 class="anchored" data-anchor-id="see-also">See Also</h2>
<p><a href="../..\documentation/modules/blockmean.html">blockmean</a>, <a href="../..\documentation/modules/blockmedian.html">blockmedian</a>, <a href="../..\documentation/modules/blockmode.html">blockmode</a>, <a href="../..\documentation/modules/nearneighbor.html">nearneighbor</a>, <a href="../..\documentation/modules/sample1d.html">sample1d</a>, <a href="../..\documentation/modules/surface.html">surface</a>, <a href="../..\documentation/modules/triangulate.html">triangulate</a></p>


</section>

</main> <!-- /main -->
<script>

// JavaScript to handle card hover effects for cards with images

document.addEventListener('DOMContentLoaded', function() {

  // Find all cards

  const cards = document.querySelectorAll('.card');



  cards.forEach(card => {

    const paragraphs = card.querySelectorAll('p');



    // If card has only one paragraph (with image)

    if (paragraphs.length === 1) {

      const p = paragraphs[0];

      const img = p.querySelector('img');



      if (img) {

        // Get all text nodes

        const textContent = Array.from(p.childNodes)

          .filter(node => node.nodeType === Node.TEXT_NODE)

          .map(node => node.textContent.trim())

          .filter(text => text.length > 0)

          .join(' ');



        if (textContent) {

          // Create overlay div for description

          const overlay = document.createElement('div');

          overlay.className = 'card-description-overlay';

          overlay.textContent = textContent;

          card.appendChild(overlay);



          // Remove text nodes completely

          Array.from(p.childNodes).forEach(node => {

            if (node.nodeType === Node.TEXT_NODE && node.textContent.trim().length > 0) {

              node.remove();

            }

          });

        }

      }

    }

  });



  // Equalize heights of grid sections (documentation cards)

  function equalizeGridHeights() {

    const grids = document.querySelectorAll('.grid');



    grids.forEach(grid => {

      const sections = Array.from(grid.querySelectorAll(':scope > section, :scope > div'));



      if (sections.length === 0) return;



      // Reset heights

      sections.forEach(section => {

        section.style.height = 'auto';

      });



      // Group sections by row (based on offsetTop)

      const rows = new Map();

      sections.forEach(section => {

        const top = section.offsetTop;

        if (!rows.has(top)) {

          rows.set(top, []);

        }

        rows.get(top).push(section);

      });



      // Equalize heights within each row

      rows.forEach(rowSections => {

        const maxHeight = Math.max(...rowSections.map(s => s.offsetHeight));

        rowSections.forEach(section => {

          section.style.height = maxHeight + 'px';

        });

      });

    });

  }



  // Run on load and resize

  equalizeGridHeights();

  window.addEventListener('resize', equalizeGridHeights);

});

</script>

<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/GenericMappingTools\.github\.io\/GMTjl_doc\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>